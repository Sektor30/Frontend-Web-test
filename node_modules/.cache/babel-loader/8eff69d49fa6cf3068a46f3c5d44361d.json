{"ast":null,"code":"import _objectSpread from\"/Users/alex/Downloads/GITHUB/testFront/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/alex/Downloads/GITHUB/testFront/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alex/Downloads/GITHUB/testFront/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/alex/Downloads/GITHUB/testFront/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{createContext,useContext,useReducer}from'react';import{register,profile,login}from'../../api/authApi';import{initialState,authReducer}from'../reducer/authReducer';import{AuthActions}from'../actions/authActions';import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext(initialState);export var useAuth=function useAuth(){var context=useContext(AuthContext);if(!context){throw new Error(\"Debería estar dentro de AuthProvider\");}return context;};export var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var signup=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2){var email,password,res,token,resUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:email=_ref2.email,password=_ref2.password;dispatch({type:AuthActions.AUTH_SIGNUP});_context.prev=2;_context.next=5;return register({email:email,password:password});case 5:res=_context.sent;token=res.data.token;localStorage.setItem(\"token\",token);if(!token){_context.next=15;break;}_context.next=11;return profile(token);case 11:resUser=_context.sent;localStorage.setItem(\"user\",JSON.stringify(resUser.data));dispatch({type:AuthActions.AUTH_SIGNUP_SUCCESS,payload:{token:token,user:resUser.data}});return _context.abrupt(\"return\",resUser.data);case 15:_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](2);if(_context.t0.response.data){dispatch({type:AuthActions.AUTH_SIGNUP_ERROR,payload:_context.t0.response.data.message});}case 20:case\"end\":return _context.stop();}}},_callee,null,[[2,17]]);}));return function signup(_x){return _ref3.apply(this,arguments);};}();var signin=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref4){var email,password,res,token,resUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:email=_ref4.email,password=_ref4.password;dispatch({type:AuthActions.AUTH_SIGNIN});_context2.prev=2;_context2.next=5;return login({email:email,password:password});case 5:res=_context2.sent;token=res.data.token;localStorage.setItem(\"token\",token);if(!token){_context2.next=15;break;}_context2.next=11;return profile(token);case 11:resUser=_context2.sent;localStorage.setItem(\"user\",JSON.stringify(resUser.data));dispatch({type:AuthActions.AUTH_SIGNIN_SUCCESS,payload:{token:token,user:resUser.data}});return _context2.abrupt(\"return\",resUser.data);case 15:_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](2);if(_context2.t0.response.data){dispatch({type:AuthActions.AUTH_SIGNIN_ERROR,payload:_context2.t0.response.data.message});}case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[2,17]]);}));return function signin(_x2){return _ref5.apply(this,arguments);};}();var logout=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:localStorage.clear();dispatch({type:AuthActions.AUTH_LOGOUT});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function logout(){return _ref6.apply(this,arguments);};}();return/*#__PURE__*/_jsx(AuthContext.Provider,{value:_objectSpread(_objectSpread({},state),{},{signup:signup,signin:signin,logout:logout}),children:children});};","map":{"version":3,"sources":["/Users/alex/Downloads/GITHUB/testFront/frontend/src/context/providers/AuthContext.js"],"names":["createContext","useContext","useReducer","register","profile","login","initialState","authReducer","AuthActions","AuthContext","useAuth","context","Error","AuthProvider","children","state","dispatch","signup","email","password","type","AUTH_SIGNUP","res","token","data","localStorage","setItem","resUser","JSON","stringify","AUTH_SIGNUP_SUCCESS","payload","user","response","AUTH_SIGNUP_ERROR","message","signin","AUTH_SIGNIN","AUTH_SIGNIN_SUCCESS","AUTH_SIGNIN_ERROR","logout","clear","AUTH_LOGOUT"],"mappings":"ogBAAA,OAAQA,aAAR,CAAuBC,UAAvB,CAAmCC,UAAnC,KAAoD,OAApD,CACA,OAASC,QAAT,CAAmBC,OAAnB,CAA4BC,KAA5B,KAAyC,mBAAzC,CACA,OAASC,YAAT,CAAuBC,WAAvB,KAA0C,wBAA1C,CACA,OAAQC,WAAR,KAA0B,wBAA1B,C,2CAEA,MAAO,IAAMC,CAAAA,WAAW,cAAGT,aAAa,CAACM,YAAD,CAAjC,CAEP,MAAO,IAAMI,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,CACzB,GAAMC,CAAAA,OAAO,CAAGV,UAAU,CAACQ,WAAD,CAA1B,CACA,GAAG,CAACE,OAAJ,CAAa,CACT,KAAM,IAAIC,CAAAA,KAAJ,CAAU,sCAAV,CAAN,CACH,CACD,MAAOD,CAAAA,OAAP,CACH,CANM,CAQP,MAAO,IAAME,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAgB,IAAdC,CAAAA,QAAc,MAAdA,QAAc,CAExC,gBAA0BZ,UAAU,CAACK,WAAD,CAAcD,YAAd,CAApC,4CAAOS,KAAP,iBAAcC,QAAd,iBAEA,GAAMC,CAAAA,MAAM,2FAAG,6KAAQC,KAAR,OAAQA,KAAR,CAAeC,QAAf,OAAeA,QAAf,CACXH,QAAQ,CAAC,CAACI,IAAI,CAAEZ,WAAW,CAACa,WAAnB,CAAD,CAAR,CADW,sCAGWlB,CAAAA,QAAQ,CAAC,CAACe,KAAK,CAALA,KAAD,CAAQC,QAAQ,CAARA,QAAR,CAAD,CAHnB,QAGDG,GAHC,eAIAC,KAJA,CAISD,GAAG,CAACE,IAJb,CAIAD,KAJA,CAMPE,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,KAA9B,EANO,IAQJA,KARI,iDASmBnB,CAAAA,OAAO,CAACmB,KAAD,CAT1B,SASGI,OATH,eAWHF,YAAY,CAACC,OAAb,CAAqB,MAArB,CAA6BE,IAAI,CAACC,SAAL,CAAeF,OAAO,CAACH,IAAvB,CAA7B,EAEAR,QAAQ,CAAC,CACLI,IAAI,CAAEZ,WAAW,CAACsB,mBADb,CAELC,OAAO,CAAE,CACLR,KAAK,CAALA,KADK,CAELS,IAAI,CAAEL,OAAO,CAACH,IAFT,CAFJ,CAAD,CAAR,CAbG,gCAqBIG,OAAO,CAACH,IArBZ,2FAyBP,GAAG,YAAMS,QAAN,CAAeT,IAAlB,CAAwB,CACpBR,QAAQ,CAAC,CACLI,IAAI,CAAEZ,WAAW,CAAC0B,iBADb,CAELH,OAAO,CAAE,YAAME,QAAN,CAAeT,IAAf,CAAoBW,OAFxB,CAAD,CAAR,CAIH,CA9BM,qEAAH,kBAANlB,CAAAA,MAAM,6CAAZ,CAkCA,GAAMmB,CAAAA,MAAM,2FAAG,kLAAQlB,KAAR,OAAQA,KAAR,CAAeC,QAAf,OAAeA,QAAf,CACXH,QAAQ,CAAC,CAACI,IAAI,CAAEZ,WAAW,CAAC6B,WAAnB,CAAD,CAAR,CADW,wCAGWhC,CAAAA,KAAK,CAAC,CAACa,KAAK,CAALA,KAAD,CAAQC,QAAQ,CAARA,QAAR,CAAD,CAHhB,QAGDG,GAHC,gBAIAC,KAJA,CAISD,GAAG,CAACE,IAJb,CAIAD,KAJA,CAMPE,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,KAA9B,EANO,IAQJA,KARI,mDASmBnB,CAAAA,OAAO,CAACmB,KAAD,CAT1B,SASGI,OATH,gBAWHF,YAAY,CAACC,OAAb,CAAqB,MAArB,CAA6BE,IAAI,CAACC,SAAL,CAAeF,OAAO,CAACH,IAAvB,CAA7B,EAEAR,QAAQ,CAAC,CACLI,IAAI,CAAEZ,WAAW,CAAC8B,mBADb,CAELP,OAAO,CAAE,CACLR,KAAK,CAALA,KADK,CAELS,IAAI,CAAEL,OAAO,CAACH,IAFT,CAFJ,CAAD,CAAR,CAbG,iCAqBIG,OAAO,CAACH,IArBZ,+FAyBP,GAAG,aAAMS,QAAN,CAAeT,IAAlB,CAAwB,CACpBR,QAAQ,CAAC,CACLI,IAAI,CAAEZ,WAAW,CAAC+B,iBADb,CAELR,OAAO,CAAE,aAAME,QAAN,CAAeT,IAAf,CAAoBW,OAFxB,CAAD,CAAR,CAIH,CA9BM,uEAAH,kBAANC,CAAAA,MAAM,8CAAZ,CAkCA,GAAMI,CAAAA,MAAM,2FAAG,wIACXf,YAAY,CAACgB,KAAb,GACAzB,QAAQ,CAAC,CACLI,IAAI,CAAEZ,WAAW,CAACkC,WADb,CAAD,CAAR,CAFW,wDAAH,kBAANF,CAAAA,MAAM,2CAAZ,CAOA,mBAAO,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,gCAAOzB,KAAP,MAAcE,MAAM,CAANA,MAAd,CAAsBmB,MAAM,CAANA,MAAtB,CAA8BI,MAAM,CAANA,MAA9B,EAA3B,UACF1B,QADE,EAAP,CAGH,CAlFM","sourcesContent":["import {createContext, useContext, useReducer} from 'react'\nimport { register, profile, login } from '../../api/authApi'\nimport { initialState, authReducer } from '../reducer/authReducer'\nimport {AuthActions} from '../actions/authActions'\n\nexport const AuthContext = createContext(initialState);\n\nexport const useAuth = () => {\n    const context = useContext(AuthContext);\n    if(!context) {\n        throw new Error(\"Debería estar dentro de AuthProvider\");\n    }\n    return context;\n};\n\nexport const AuthProvider = ({children}) => {\n\n    const [state, dispatch] = useReducer(authReducer, initialState);\n\n    const signup = async ({email, password}) => {\n        dispatch({type: AuthActions.AUTH_SIGNUP})\n        try {\n            const res = await register({email, password});\n            const {token} = res.data;\n\n            localStorage.setItem(\"token\", token);\n\n            if(token) {\n                const resUser = await profile(token);\n\n                localStorage.setItem(\"user\", JSON.stringify(resUser.data));\n\n                dispatch({ \n                    type: AuthActions.AUTH_SIGNUP_SUCCESS, \n                    payload: {\n                        token,\n                        user: resUser.data\n                    },\n                });\n\n                return resUser.data;\n            }\n\n        } catch (error) {\n            if(error.response.data) {\n                dispatch({ \n                    type: AuthActions.AUTH_SIGNUP_ERROR, \n                    payload: error.response.data.message\n                });\n            }\n        }\n    };\n\n    const signin = async ({email, password}) => {\n        dispatch({type: AuthActions.AUTH_SIGNIN})\n        try {\n            const res = await login({email, password});\n            const {token} = res.data;\n\n            localStorage.setItem(\"token\", token);\n\n            if(token) {\n                const resUser = await profile(token);\n\n                localStorage.setItem(\"user\", JSON.stringify(resUser.data));\n\n                dispatch({ \n                    type: AuthActions.AUTH_SIGNIN_SUCCESS, \n                    payload: {\n                        token,\n                        user: resUser.data\n                    },\n                });\n\n                return resUser.data;\n            }\n\n        } catch (error) {\n            if(error.response.data) {\n                dispatch({ \n                    type: AuthActions.AUTH_SIGNIN_ERROR, \n                    payload: error.response.data.message\n                });\n            }\n        }\n    };\n\n    const logout = async () => {\n        localStorage.clear();\n        dispatch({\n            type: AuthActions.AUTH_LOGOUT,\n        })\n    }\n\n    return <AuthContext.Provider value={{ ...state, signup, signin, logout }}>\n        {children}\n    </AuthContext.Provider>\n}\n\n"]},"metadata":{},"sourceType":"module"}